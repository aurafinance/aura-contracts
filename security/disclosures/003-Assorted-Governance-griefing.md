## Security Report 03

| Title           | Governance Griefing                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| :-------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Date            | Dec 12, 2022                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Asset           | Contracts                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Risk            | Low (Governance griefing)                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Status          | Resolved                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Resolution link | https://github.com/aurafinance/aura-contracts/pull/143                                                                                                                                                                                                                                                                                                                                                                                                               |
| Audit link      | [Link](../audits/migration)                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Effects         | Governance can redirect rewards and deposit tokens                                                                                                                                                                                                                                                                                                                                                                                                                   |
| Description     | <ul><li>A fee distributor can be added that when processed will shutdown any Aura pool and distribute the LP tokens to auraBAL stakers</li><li>Add a reward hook to each reward contract that calls earmarkRewards for a pool controlled by governance redirecting all incoming BAL</li><li>Add BAL as a pool to AURA using forceAddPool. Then add reward hooks to each reward contract that calls withdraw on the BAL pool and redirects all incoming BAL</li></ul> |
| Details of fix  | Added reentrency guards to shutdownPool, deposit, \_withdraw, earmarkRewards and earmarkFees and redeployed as part of LP migration.                                                                                                                                                                                                                                                                                                                                 |

### Disclosure details

| Title       | BaseRewardPool Donate |
| :---------- | :-------------------- |
| Channel     | Immunefi              |
| Scope       | Not in scope          |
| Bounty paid | Yes                   |
